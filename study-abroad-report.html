<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0" />
    <title>Riset Minat Studi Luar Negeri - Solo Youth Insights 2025</title>

    <!-- Favicon Configuration -->
    <link rel="apple-touch-icon" sizes="180x180" href="assets/favicon/apple-touch-icon.png" />
    <link rel="icon" type="image/png" sizes="32x32" href="assets/favicon/favicon-32x32.png" />
    <link rel="icon" type="image/png" sizes="16x16" href="assets/favicon/favicon-16x16.png" />
    <link rel="manifest" href="assets/favicon/site.webmanifest" />
    <link rel="shortcut icon" href="assets/favicon/favicon.ico" />
    <meta name="msapplication-TileColor" content="#292F36" />
    <meta name="msapplication-TileImage" content="assets/favicon/android-chrome-192x192.png" />
    <meta name="theme-color" content="#292F36" />

    <!-- SEO Meta Tags -->
    <meta name="description" content="Laporan riset lengkap tentang minat studi luar negeri generasi muda Surakarta. Analisis data dari Facebook, Instagram, TikTok, dan Twitter." />
    <meta name="keywords" content="studi luar negeri, beasiswa, Solo, Surakarta, pendidikan, riset, data, TikTok, Instagram" />

    <!-- External Libraries -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet" />

    <!-- Custom CSS -->
    <link rel="stylesheet" href="assets/css/main.css" />
    <link rel="stylesheet" href="assets/css/report.css" />

    <!-- Tailwind Configuration -->
    <script src="assets/js/config.js"></script>
  </head>
  <body class="bg-solo-light text-solo-dark font-sans min-h-screen">
    <!-- Navigation -->
    <nav class="bg-solo-dark text-white p-3 md:p-4 sticky top-0 z-50 shadow-lg">
      <div class="max-w-6xl mx-auto flex justify-between items-center gap-2">
        <a href="index.html" class="flex items-center gap-2 hover:bg-solo-primary/10 p-2 rounded-lg transition min-w-0">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 md:h-6 md:w-6 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18" />
          </svg>
          <span class="font-semibold text-sm md:text-base truncate">Kembali ke Dashboard</span>
        </a>
        <div class="flex items-center gap-2 md:gap-3 min-w-0">
          <div class="h-6 w-6 md:h-8 md:w-8 bg-solo-primary rounded-full flex items-center justify-center flex-shrink-0">
            <span class="font-bold text-white text-sm md:text-base">S</span>
          </div>
          <span class="text-base md:text-lg font-bold truncate">Solo Youth Insights 2025</span>
        </div>
      </div>
    </nav>

    <!-- Main Report Content -->
    <main class="max-w-6xl mx-auto px-3 md:px-4 py-4 md:py-8" id="report-content">
      <!-- Progress Indicator -->
      <div class="sticky top-16 md:top-20 z-40 bg-white/90 backdrop-blur-sm rounded-xl p-3 md:p-4 mb-6 md:mb-8 shadow-lg border border-gray-100">
        <div class="flex flex-col sm:flex-row sm:justify-between sm:items-center gap-2">
          <div class="text-xs md:text-sm text-gray-600 flex items-center gap-2">
            <span class="hidden sm:inline">Progress Membaca:</span>
            <span class="sm:hidden">Progress:</span>
            <span id="progress-percent" class="font-semibold">0%</span>
          </div>
          <div class="w-full sm:w-48 md:w-64 bg-gray-200 rounded-full h-1.5 md:h-2">
            <div id="progress-bar" class="bg-solo-primary h-1.5 md:h-2 rounded-full transition-all duration-300" style="width: 0%"></div>
          </div>
        </div>
      </div>

      <!-- Header -->
      <section class="text-center mb-8 md:mb-16 px-2">
        <div class="inline-block mb-4 md:mb-6 px-4 md:px-6 py-2 md:py-3 bg-gradient-to-r from-solo-primary to-blue-500 rounded-full">
          <span class="text-white font-semibold text-sm md:text-base">Riset Pendidikan Internasional</span>
        </div>
        <h1 class="text-2xl sm:text-3xl md:text-4xl lg:text-5xl xl:text-6xl font-bold text-solo-dark mb-4 md:mb-6 leading-snug md:leading-tight">
          <span class="bg-gradient-to-r from-solo-primary to-blue-600 bg-clip-text text-transparent block mb-2">Eksodus Akademik</span>
          <span class="text-lg sm:text-xl md:text-2xl lg:text-3xl xl:text-4xl block mb-2">Mengurai Minat Studi Luar Negeri</span>
          <span class="text-base sm:text-lg md:text-xl lg:text-2xl xl:text-3xl text-solo-gray block">Generasi Muda Surakarta</span>
        </h1>
        <p class="text-sm sm:text-base md:text-lg lg:text-xl text-gray-600 max-w-3xl mx-auto mb-6 md:mb-8 px-2">
          Analisis komprehensif berbasis social listening terhadap perilaku, motivasi, dan tantangan pelajar Solo dalam mengejar pendidikan tinggi di luar negeri.
        </p>

        <div class="flex flex-wrap justify-center gap-2 md:gap-4 mt-6 md:mt-8">
          <div class="flex items-center gap-1 md:gap-2 bg-white px-3 py-1.5 rounded-full shadow-sm border border-gray-100">
            <div class="w-2 h-2 md:w-3 md:h-3 bg-green-500 rounded-full animate-pulse"></div>
            <span class="text-xs md:text-sm text-gray-700">Data Terbaru: Des 2025</span>
          </div>
          <div class="flex items-center gap-1 md:gap-2 bg-white px-3 py-1.5 rounded-full shadow-sm border border-gray-100">
            <div class="w-2 h-2 md:w-3 md:h-3 bg-blue-500 rounded-full"></div>
            <span class="text-xs md:text-sm text-gray-700">4 Platform Media Sosial</span>
          </div>
          <div class="flex items-center gap-1 md:gap-2 bg-white px-3 py-1.5 rounded-full shadow-sm border border-gray-100">
            <div class="w-2 h-2 md:w-3 md:h-3 bg-purple-500 rounded-full"></div>
            <span class="text-xs md:text-sm text-gray-700">1,500+ Data Point</span>
          </div>
        </div>
      </section>

      <!-- Table of Contents -->
      <section class="mb-8 md:mb-12 bg-white rounded-xl md:rounded-2xl p-4 md:p-6 shadow-lg border border-gray-100">
        <h2 class="text-lg md:text-xl lg:text-2xl font-bold text-solo-dark mb-4 md:mb-6 flex items-center gap-2 md:gap-3">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 md:h-8 md:w-8 text-solo-primary flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 10h16M4 14h16M4 18h16" />
          </svg>
          <span>Daftar Isi</span>
        </h2>
        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-2 md:gap-3 lg:gap-4">
          <a href="#charts-container" class="toc-item p-3 md:p-4 border border-gray-200 rounded-lg hover:border-solo-primary hover:bg-blue-50 transition text-left">
            <div class="flex items-center gap-2 md:gap-3">
              <div class="w-6 h-6 md:w-8 md:h-8 bg-solo-primary/10 rounded-lg flex items-center justify-center flex-shrink-0">
                <span class="text-solo-primary font-bold text-sm md:text-base">0</span>
              </div>
              <span class="font-semibold text-sm md:text-base truncate">Visualisasi Data</span>
            </div>
          </a>
          <a href="#executive-summary" class="toc-item p-3 md:p-4 border border-gray-200 rounded-lg hover:border-solo-primary hover:bg-blue-50 transition text-left">
            <div class="flex items-center gap-2 md:gap-3">
              <div class="w-6 h-6 md:w-8 md:h-8 bg-solo-primary/10 rounded-lg flex items-center justify-center flex-shrink-0">
                <span class="text-solo-primary font-bold text-sm md:text-base">1</span>
              </div>
              <span class="font-semibold text-sm md:text-base truncate">Executive Summary</span>
            </div>
          </a>
          <a href="#methodology" class="toc-item p-3 md:p-4 border border-gray-200 rounded-lg hover:border-solo-primary hover:bg-blue-50 transition text-left">
            <div class="flex items-center gap-2 md:gap-3">
              <div class="w-6 h-6 md:w-8 md:h-8 bg-solo-primary/10 rounded-lg flex items-center justify-center flex-shrink-0">
                <span class="text-solo-primary font-bold text-sm md:text-base">2</span>
              </div>
              <span class="font-semibold text-sm md:text-base truncate">Metodologi & Sampel</span>
            </div>
          </a>
          <a href="#platform-analysis" class="toc-item p-3 md:p-4 border border-gray-200 rounded-lg hover:border-solo-primary hover:bg-blue-50 transition text-left">
            <div class="flex items-center gap-2 md:gap-3">
              <div class="w-6 h-6 md:w-8 md:h-8 bg-solo-primary/10 rounded-lg flex items-center justify-center flex-shrink-0">
                <span class="text-solo-primary font-bold text-sm md:text-base">3</span>
              </div>
              <span class="font-semibold text-sm md:text-base truncate">Analisis Platform</span>
            </div>
          </a>
          <a href="#demographics" class="toc-item p-3 md:p-4 border border-gray-200 rounded-lg hover:border-solo-primary hover:bg-blue-50 transition text-left">
            <div class="flex items-center gap-2 md:gap-3">
              <div class="w-6 h-6 md:w-8 md:h-8 bg-solo-primary/10 rounded-lg flex items-center justify-center flex-shrink-0">
                <span class="text-solo-primary font-bold text-sm md:text-base">4</span>
              </div>
              <span class="font-semibold text-sm md:text-base truncate">Demografi & Psikografi</span>
            </div>
          </a>
          <a href="#behavior" class="toc-item p-3 md:p-4 border border-gray-200 rounded-lg hover:border-solo-primary hover:bg-blue-50 transition text-left">
            <div class="flex items-center gap-2 md:gap-3">
              <div class="w-6 h-6 md:w-8 md:h-8 bg-solo-primary/10 rounded-lg flex items-center justify-center flex-shrink-0">
                <span class="text-solo-primary font-bold text-sm md:text-base">5</span>
              </div>
              <span class="font-semibold text-sm md:text-base truncate">Peta Perilaku</span>
            </div>
          </a>
          <a href="#insights" class="toc-item p-3 md:p-4 border border-gray-200 rounded-lg hover:border-solo-primary hover:bg-blue-50 transition text-left">
            <div class="flex items-center gap-2 md:gap-3">
              <div class="w-6 h-6 md:w-8 md:h-8 bg-solo-primary/10 rounded-lg flex items-center justify-center flex-shrink-0">
                <span class="text-solo-primary font-bold text-sm md:text-base">6</span>
              </div>
              <span class="font-semibold text-sm md:text-base truncate">Insight Strategis</span>
            </div>
          </a>
          <a href="#footnotes" class="toc-item p-3 md:p-4 border border-gray-200 rounded-lg hover:border-solo-primary hover:bg-blue-50 transition text-left">
            <div class="flex items-center gap-2 md:gap-3">
              <div class="w-6 h-6 md:w-8 md:h-8 bg-solo-primary/10 rounded-lg flex items-center justify-center flex-shrink-0">
                <span class="text-solo-primary font-bold text-sm md:text-base">7</span>
              </div>
              <span class="font-semibold text-sm md:text-base truncate">Referensi & Catatan</span>
            </div>
          </a>
        </div>
      </section>

      <!-- Chart Container -->
      <div id="charts-container" class="mobile-scroll-container"></div>

      <!-- Report Sections -->
      <div id="report-sections" class="prose-report max-w-none"></div>

      <!-- Back to Dashboard Button -->
      <div class="text-center mt-8 md:mt-12 mb-8 md:mb-16">
        <a
          href="index.html"
          class="inline-flex items-center justify-center gap-2 bg-solo-primary text-white px-4 py-2 md:px-6 md:py-3 rounded-lg hover:bg-solo-primary/90 transition-colors font-semibold text-sm md:text-base shadow-md hover:shadow-lg w-full sm:w-auto"
        >
          <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18" />
          </svg>
          Kembali ke Dashboard Utama
        </a>
      </div>
    </main>

    <!-- JavaScript Files -->
    <script src="assets/js/charts.js"></script>
    <script src="assets/js/report/chart.js"></script>
    <script src="assets/js/report-content.js"></script>

    <script>
      document.addEventListener("DOMContentLoaded", () => {
        const CHART_IDS = ["platform-usage-chart", "country-distribution-chart", "motivation-chart", "scholarship-interest-chart", "decision-journey-chart", "concerns-chart", "timeline-chart", "demographic-chart"];

        // IDs we want to prioritize (above-the-fold)
        const PRIORITY = new Set(["platform-usage-chart", "decision-journey-chart", "demographic-chart"]);

        const chartsContainer = document.getElementById("charts-container");
        if (!chartsContainer) return;

        function ensureSkeletonOn(container, canvasId) {
          if (!container) return;
          // add data-chart-id attribute if missing
          if (!container.dataset.chartId) container.dataset.chartId = canvasId || container.querySelector("canvas")?.id || "";

          // set priority if it's one of the recommended IDs
          if (PRIORITY.has(container.dataset.chartId)) container.dataset.chartPriority = "high";

          // add skeleton overlay if missing
          if (!container.querySelector(".chart-skeleton")) {
            const sk = document.createElement("div");
            sk.className = "chart-skeleton";
            sk.innerHTML = `<div class="pulse" aria-hidden="true"></div><div class="label">Memuat visualâ€¦</div>`;
            container.appendChild(sk);
          } else {
            // make sure visible
            const sk = container.querySelector(".chart-skeleton");
            sk.classList.remove("hidden");
          }
        }

        function annotateExisting() {
          // prefer explicit containers (elements with .chart-container inside charts-container)
          const chartContainers = chartsContainer.querySelectorAll(".chart-container");
          chartContainers.forEach((cont) => {
            const canvas = cont.querySelector("canvas");
            const canvasId = canvas?.id || cont.dataset.chartId || "";
            if (canvasId) ensureSkeletonOn(cont, canvasId);
          });

          // also check for bare canvases (if markup is minimal)
          CHART_IDS.forEach((id) => {
            const canvas = chartsContainer.querySelector(`#${id}`);
            if (canvas) {
              const cont = canvas.closest(".chart-container") || canvas.parentElement;
              ensureSkeletonOn(cont, id);
            }
          });
        }

        // If markup not yet injected, observe #charts-container for additions
        let observer;
        function startMutationObserver() {
          if (observer) return;
          observer = new MutationObserver((mutations) => {
            annotateExisting();
            // if we found at least one canvas, we can disconnect after some time
            const found = chartsContainer.querySelector("canvas");
            if (found) {
              setTimeout(() => {
                try {
                  observer.disconnect();
                } catch (e) {}
              }, 800);
            }
          });
          observer.observe(chartsContainer, { childList: true, subtree: true });
        }

        // Run initial annotate (covers the case if report-content already injected)
        annotateExisting();
        startMutationObserver();

        // Hide skeleton when chart:ready event dispatched by report/chart.js
        document.addEventListener("chart:ready", (e) => {
          try {
            const id = e?.detail?.id;
            if (!id) return;
            const container = document.querySelector(`[data-chart-id="${id}"]`);
            const skeleton = container?.querySelector(".chart-skeleton");
            if (skeleton) skeleton.classList.add("hidden");
          } catch (err) {
            /* noop */
          }
        });

        // Also hide skeleton when chart instance is present in window.reportCharts (in case chart:ready not fired)
        const tryHideFromInstances = () => {
          const rc = window.reportCharts;
          if (!rc || !rc.charts) return;
          Object.keys(rc.charts).forEach((k) => {
            const container = document.querySelector(`[data-chart-id="${k}"]`);
            const skeleton = container?.querySelector(".chart-skeleton");
            if (skeleton) skeleton.classList.add("hidden");
          });
        };
        // small polling but limited and cheap (stop after few tries)
        let tries = 0;
        const poll = setInterval(() => {
          tries++;
          tryHideFromInstances();
          if ((window.reportCharts && Object.keys(window.reportCharts.charts || {}).length >= 3) || tries > 10) {
            clearInterval(poll);
          }
        }, 300);

        // Safety fallback: remove skeletons after 6s to avoid stuck UI on very edge cases
        setTimeout(() => {
          document.querySelectorAll(".chart-skeleton").forEach((s) => s.classList.add("hidden"));
          try {
            if (observer) observer.disconnect();
          } catch (e) {}
        }, 6000);
      });
    </script>

    <!-- Responsive Scripts -->
    <script>
      // Scroll progress indicator
      window.addEventListener("scroll", function () {
        const content = document.getElementById("report-content");
        if (!content) return;

        const contentHeight = content.offsetHeight;
        const windowHeight = window.innerHeight;
        const scrollTop = window.pageYOffset || document.documentElement.scrollTop;

        const progress = ((scrollTop + windowHeight) / (contentHeight + windowHeight)) * 100;
        const progressBar = document.getElementById("progress-bar");
        const progressPercent = document.getElementById("progress-percent");

        if (progressBar && progressPercent) {
          const percent = Math.min(100, Math.max(0, progress));
          progressBar.style.width = percent + "%";
          progressPercent.textContent = Math.round(percent) + "%";
        }
      });

      // Smooth scroll for table of contents
      document.addEventListener("DOMContentLoaded", function () {
        document.querySelectorAll(".toc-item").forEach((item) => {
          item.addEventListener("click", function (e) {
            e.preventDefault();
            const targetId = this.getAttribute("href");
            const targetElement = document.querySelector(targetId);

            if (targetElement) {
              const offset = window.innerWidth < 768 ? 80 : 100;
              window.scrollTo({
                top: targetElement.offsetTop - offset,
                behavior: "smooth",
              });
            }
          });
        });

        // Responsive table handling
        document.querySelectorAll("table").forEach((table) => {
          const wrapper = document.createElement("div");
          wrapper.className = "mobile-scroll-container";
          table.parentNode.insertBefore(wrapper, table);
          wrapper.appendChild(table);
        });
      });

      function applyResponsiveClasses() {
        // Add responsive classes to headings in report content
        document.querySelectorAll("#report-sections h2").forEach((h2) => {
          if (!h2.classList.contains("text-responsive")) {
            h2.className = "text-xl md:text-2xl lg:text-3xl font-bold text-solo-dark mb-4 md:mb-6 mt-6 md:mt-8 text-responsive";
          }
        });

        document.querySelectorAll("#report-sections h3").forEach((h3) => {
          if (!h3.classList.contains("text-responsive")) {
            h3.className = "text-lg md:text-xl font-semibold text-solo-dark mb-3 md:mb-4 mt-4 md:mt-6 text-responsive";
          }
        });

        document.querySelectorAll("#report-sections p").forEach((p) => {
          if (!p.classList.contains("text-responsive")) {
            p.classList.add("text-sm", "md:text-base", "mb-3", "md:mb-4", "text-gray-700");
          }
        });

        document.querySelectorAll("#report-sections ul, #report-sections ol").forEach((list) => {
          list.classList.add("pl-4", "md:pl-6", "mb-4", "md:mb-6");
        });

        document.querySelectorAll("#report-sections li").forEach((li) => {
          li.classList.add("text-sm", "md:text-base", "mb-2", "text-gray-700");
        });
      }

      // Load footer and report content
      document.addEventListener("DOMContentLoaded", function () {
        // Load report content
        if (typeof ReportContent !== "undefined") {
          const reportContent = new ReportContent();
          reportContent.loadComponents();
        } else {
          console.log("ReportContent class not found, loading components manually");
          // Fallback: Load essential report components
          const components = ["report/executive-summary", "report/methodology", "report/platform-analysis", "report/demographics", "report/behavior", "report/insights", "report/footnotes"];

          components.forEach((comp) => {
            loadComponent(comp, "report-sections");
          });
        }
      });

      // Handle window resize
      let resizeTimer;
      window.addEventListener("resize", function () {
        clearTimeout(resizeTimer);
        resizeTimer = setTimeout(function () {
          applyResponsiveClasses();
        }, 250);
      });
    </script>
  </body>
</html>
